<!DOCTYPE html>
<html>
<head>
    <title>Создание персонажа</title>
    <style>
        body { font-family: sans-serif; max-width: 900px; margin: auto; padding: 20px; background: #f4f4f4; }
        fieldset { background: white; border: 1px solid #ccc; border-radius: 8px; padding: 15px; margin-bottom: 20px; }
        .dynamic-row { display: flex; gap: 10px; margin-bottom: 10px; align-items: center; }
        label { display: inline-block; width: 120px; font-weight: bold; }
        input[type="number"] { width: 60px; }
        .btn-add { background: #007bff; color: white; border: none; padding: 5px 10px; cursor: pointer; border-radius: 4px; }
    </style>
</head>
<body>
    <h1>Новый герой</h1>
    <form method="POST">
        <fieldset>
            <legend>Базовая информация</legend>
            <label>Имя:</label> <input type="text" name="name" required>
            <label>Ранг (1-5):</label> <input type="number" name="rank" value="1">
        </fieldset>

        <fieldset>
            <legend>Атрибуты (База 4, +1 = 10 очков)</legend>
            <label>Тело:</label> <input type="number" name="body" value="4">
            <label>Разум:</label> <input type="number" name="mind" value="4">
            <label>Дух:</label> <input type="number" name="spirit" value="4">
        </fieldset>

        {% for cat, skills in skills_map.items() %}
        <fieldset>
            <legend>Навыки: {{ cat }} (База 4, +1 = 5 очков)</legend>
            {% for s in skills %}
            <label style="width: 140px;">{{ s }}:</label> <input type="number" name="{{ s }}" value="4">
            {% endfor %}
        </fieldset>
        {% endfor %}

        <fieldset id="advantages-section">
            <legend>Достоинства (Уровень * 5 очков)</legend>
            <div id="adv-container"></div>
            <button type="button" class="btn-add" onclick="addAdv()">+ Добавить достоинство</button>
        </fieldset>

        <fieldset id="miracles-section">
            <legend>Чудеса (Уровень * Ранг очков)</legend>
            <div id="mir-container"></div>
            <button type="button" class="btn-add" onclick="addMir()">+ Добавить чудо</button>
        </fieldset>

        <button type="submit" style="width: 100%; padding: 15px; background: #28a745; color: white; border: none; font-size: 1.2em; border-radius: 8px;">СОЗДАТЬ ПЕРСОНАЖА</button>
    </form>

    <script>
        function addAdv() {
            const div = document.createElement('div');
            div.className = 'dynamic-row';
            div.innerHTML = `<input type="text" name="adv_name[]" placeholder="Название"> 
                             Уровень: <input type="number" name="adv_val[]" value="1">`;
            document.getElementById('adv-container').appendChild(div);
        }
        function addMir() {
            const div = document.createElement('div');
            div.className = 'dynamic-row';
            div.innerHTML = `<input type="text" name="mir_name[]" placeholder="Название"> 
                             Ранг: <input type="number" name="mir_rank[]" value="1"> 
                             Уровень: <input type="number" name="mir_level[]" value="1">`;
            document.getElementById('mir-container').appendChild(div);
        }
    </script>
</body>
</html>
